<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Patient | RehabCare+</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="sidebar" id="sidebar">
        <h4>RehabCare+</h4>
        <a href="/dashboard">üè† Dashboard</a>
        <a href="/add_patient" class="active">‚ûï Add Patient</a>
        <a href="/patients">üßç Patients List</a>
        <a href="/rooms">üõè Rooms</a>
        <a href="/billing">üí≥ Billing</a>
        <a href="/medicine_history">üíä Medicine History</a>
        <a href="/logout">üö™ Logout</a>
    </div>

    <div class="content">
        <div class="navbar-custom">
            <span class="nav-title">Add New Patient</span>
            <button class="btn-outline btn-custom" onclick="toggleSidebar()">‚ò∞</button>
        </div>
        
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                <div class="flash-message flash-{{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <div class="card-custom" style="padding: 30px;">
            <h3 style="margin-bottom: 25px; color: var(--primary-blue);">Patient Admission Form</h3>

            <form action="/add_patient" method="POST" class="patient-form">
                
                <h4 class="form-section-title">üë§ Personal Details</h4>
                
                <div class="form-row">
                    <div class="input-group">
                        <label>Full Name *</label>
                        <input type="text" name="full_name" placeholder="e.g. Ahmed Khan" required>
                    </div>
                    <div class="input-group">
                        <label>Date of Birth *</label>
                        <input type="date" name="dob" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="input-group">
                        <label>Gender *</label>
                        <select name="gender" required>
                            <option value="">Select Gender</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>Branch *</label>
                        <select name="branch_id" required>
                            <option value="">Select Branch</option>
                            {% for branch in branches %}
                                <option value="{{ branch.branch_id }}">{{ branch.branch_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <div class="input-group">
                    <label>Admission Date *</label>
                    <input type="date" name="admission_date" value="{{ today }}" required>
                </div>
                
                <h4 class="form-section-title">‚öïÔ∏è Medical & Addiction Information</h4>

                <div class="form-row">
                    <div class="input-group">
                        <label>Primary Drug of Addiction *</label>
                        <select name="primary_addiction" required>
                            <option value="">Select Primary Addiction</option>
                            <option value="Heroin">Heroin</option>
                            <option value="Prescription Opioids">Prescription Opioids</option>
                            <option value="Alcohol">Alcohol</option>
                            <option value="Cannabis">Cannabis (Marijuana)</option>
                            <option value="Cocaine">Cocaine</option>
                            <option value="Methamphetamine">Methamphetamine (Ice)</option>
                            <option value="Benzodiazepines">Benzodiazepines</option>
                            <option value="Cigarettes/Nicotine">Cigarettes/Nicotine</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>Duration of Use (Months) *</label>
                        <input type="number" name="duration_months" placeholder="e.g. 60" min="1" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="input-group">
                        <label>Addiction Level *</label>
                        <select name="addiction_level" required>
                            <option value="">Select Level</option>
                            <option value="Low">Low</option>
                            <option value="Moderate">Moderate</option>
                            <option value="High">High</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="input-group">
                        <label>Pre-existing Diseases</label>
                        <textarea name="diseases" rows="2" placeholder="e.g. Hepatitis C, Diabetes, Hypertension (or 'None')">None</textarea>
                    </div>
                    <div class="input-group">
                        <label>Known Allergies</label>
                        <textarea name="allergies" rows="2" placeholder="e.g. Penicillin, Dust (or 'None')">None</textarea>
                    </div>
                </div>

                <div class="input-group">
                    <label>Initial Notes / Observations</label>
                    <textarea name="notes" rows="3" placeholder="Any important notes about the patient..."></textarea>
                </div>

                <h4 class="form-section-title">üë®‚Äçüë©‚Äçüëß Guardian / Emergency Contact</h4>
                
                <div class="form-row">
                    <div class="input-group">
                        <label>Guardian Name *</label>
                        <input type="text" name="guardian_name" placeholder="e.g. Zaheer Khan" required>
                    </div>
                    <div class="input-group">
                        <label>Relation *</label>
                        <input type="text" name="guardian_relation" placeholder="e.g. Father, Mother, Spouse" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="input-group">
                        <label>Guardian Phone *</label>
                        <input type="text" name="guardian_phone" placeholder="e.g. 0300-1234567" required>
                    </div>
                    <div class="input-group">
                        <label>Guardian Address</label>
                        <input type="text" name="guardian_address" placeholder="Complete address">
                    </div>
                </div>
                
                <button type="submit" class="btn-submit">üíæ Add Patient & Proceed to Room Allocation</button>

            </form>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>
</html>